# -*- coding: utf-8 -*-
# flake8: noqa


# WARNING: This file is automatically generated by a script. No not modify it by hand!

# Original files are "chap-isf.json" and "chap-isf.m"


DISFBASE = ISFBASE

TR2_ISF = arr(max(0, min(DISFBASE, LIM_TR2_ISF) - LIM_TR1_ISF) * TX_TR2_ISF / 10000)


TR3_ISF = arr(max(0, min(DISFBASE, LIM_TR3_ISF) - LIM_TR2_ISF) * TX_TR3_ISF / 10000)


TR4_ISF = arr(max(0, min(DISFBASE, LIM_TR4_ISF) - LIM_TR3_ISF) * TX_TR4_ISF / 100)


TR5_ISF = arr(max(0, min(DISFBASE, LIM_TR5_ISF) - LIM_TR4_ISF) * TX_TR5_ISF / 10000)


TR6_ISF = arr(max(0, DISFBASE - LIM_TR5_ISF) * TX_TR6_ISF / 1000)


ISF1 = TR2_ISF + TR3_ISF + TR4_ISF + TR5_ISF + TR6_ISF

ISFDEC = arr(17500 - TX_TR5_ISF / 10000 * ISFBASE * positif(ISFBASE - LIM_ISFINF) * positif(LIM_ISFDEC - ISFBASE)) * positif(ISF1)


DISFDEC = ISFDEC

ISFBRUT = arr(ISF1 - ISFDEC * positif(LIM_ISFDEC - 1 - ISFBASE) + ISF1 * 1 - positif(LIM_ISFDEC - 1 - ISFBASE))

DISFPMED = ISFPMEDI


DISFPMEI = ISFPMEIN


AISFPMED = arr(ISFPMEDI * TX50 / 100)


AISFPMEI = arr(ISFPMEIN * TX50 / 100)


RISFPMED_1 = min(45000, AISFPMED)


RISFPMEI_1 = max(0, min(45000 - RISFPMED_1, AISFPMEI))


DISFFIP = ISFFIP


DISFFCPI = ISFFCPI


AISFFIP = arr(ISFFIP * TX50 / 100)


AISFFCPI = arr(ISFFCPI * TX50 / 100)


RISFFIP_1 = min(18000, AISFFIP)


RISFFCPI_1 = max(0, min(18000 - RISFFIP_1, AISFFCPI))

PLAF_ISFRED = 50000 * 1 - positif(ISFPMEDI + ISFPMEIN + ISFFIP + ISFFCPI) + 45000 * positif(ISFPMEDI + ISFPMEIN + ISFFIP + ISFFCPI)


DISFDONF = ISFDONF


DISFDONCEE = ISFDONEURO


AISFDONF = arr(ISFDONF * TX75 / 100)


AISFDONCEE = arr(ISFDONEURO * TX75 / 100)


RISFDONF_1 = min(PLAF_ISFRED, AISFDONF)


RISFDONCEE_1 = max(0, min(PLAF_ISFRED - RISFDONF_1, AISFDONCEE))

RISFDONF_2 = min(PLAF_ISFRED, RISFDONF_1)


RISFDONCEE_2 = max(0, min(PLAF_ISFRED - RISFDONF_1, RISFDONCEE_1))


RISFPMED_2 = max(0, min(PLAF_ISFRED - RISFDONF_1 - RISFDONCEE_1, RISFPMED_1))


RISFPMEI_2 = max(0, min(PLAF_ISFRED - RISFDONF_1 - RISFDONCEE_1 - RISFPMED_1, RISFPMEI_1))


RISFFIP_2 = max(0, min(PLAF_ISFRED - RISFDONF_1 - RISFDONCEE_1 - RISFPMED_1 - RISFPMEI_1, RISFFIP_1))


RISFFCPI_2 = max(0, min(PLAF_ISFRED - RISFDONF_1 - RISFDONCEE_1 - RISFPMED_1 - RISFPMEI_1 - RISFFIP_1, RISFFCPI_1))


RISFDONF = max(min(RISFDONF_2, ISFBRUT), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFDONF_2, ISFBRUT), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA


RISFDONCEE = max(min(RISFDONCEE_2, ISFBRUT - RISFDONF), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFDONCEE_2, ISFBRUT - RISFDONF), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA


RISFPMED = max(min(RISFPMED_2, ISFBRUT - RISFDONF - RISFDONCEE), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFPMED_2, ISFBRUT - RISFDONF - RISFDONCEE), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA


RISFPMEI = max(min(RISFPMEI_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFPMEI_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA


RISFFIP = max(min(RISFFIP_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED - RISFPMEI), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFFIP_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED - RISFPMEI), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA


RISFFCPI = max(min(RISFFCPI_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED - RISFPMEI - RISFFIP), 0) * positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) + max(min(RISFFCPI_2, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED - RISFPMEI - RISFFIP), 0) * 1 - positif(1 - null(CODE_2042 - 8) * 1 - null(CMAJ_ISF - 8) * 1 - null(CMAJ_ISF - 34)) * COD9ZA

REDISF = RISFDONF + RISFDONCEE + RISFPMED + RISFPMEI + RISFFIP + RISFFCPI


TXTOISF = RETXISF + COPETOISF

ISFTRED = RISFDONF + RISFDONCEE + RISFPMED + RISFPMEI + RISFFIP + RISFFCPI + RISFE

ISFNETRED = max(0, ISFBRUT - RISFDONF - RISFDONCEE - RISFPMED - RISFPMEI - RISFFIP - RISFFCPI)

DISFPLAF = ISFPLAF


RISFPLAF = max(0, ISFNETRED * positif(ISFPLAF - ISFNETRED) + ISFPLAF * 1 - positif(ISFPLAF - ISFNETRED))

ISFPOSTPLAF = max(0, ISFNETRED - RISFPLAF)

DISFE = ISFETRANG


RISFE = positif(DISFBASE) * positif(ISFETRANG) * min(ISFPOSTPLAF, ISFETRANG)

ISF5 = max(0, ISFPOSTPLAF - RISFE)

COPETOISF = 10 if (CMAJ_ISF == 7 or CMAJ_ISF == 17 or CMAJ_ISF == 18) else (40 if (CMAJ_ISF == 8 or CMAJ_ISF == 34) else 0)


NMAJISF1 = max(0, MAJO1728ISF + arr(ISF5 * COPETOISF / 100) * positif_ou_nul(ISF5 - SEUIL_12) + FLAG_TRTARDIF * MAJOISFTARDIF_D + FLAG_TRTARDIF_F * MAJOISFTARDIF_D - FLAG_TRTARDIF_F * positif(FLAG_RECTIF) * MAJOISFTARDIF_R + 1 - positif(FLAG_RECTIF) * MAJOISFTARDIF_A)


TXPF1728ISF = 10 if (V_CODPF1728ISF == 7 or V_CODPF1728ISF == 17 or V_CODPF1728ISF == 18) else (40 if (V_CODPF1728ISF == 8 or V_CODPF1728ISF == 34) else 0)


MAJTXISF1 = 1 - positif(V_NBCOD1728ISF) * 1 - positif(CMAJ_ISF) * positif(NMAJISF1) * TXPF1728ISF + positif(CMAJ_ISF) * COPETOISF + positif(V_NBCOD1728ISF) * -1

INTMSISF = inf(MOISAN_ISF / 10000)


INTANISF = MOISAN_ISF / 10000 - INTMSISF * 10000 * present(MOISAN_ISF)


TXINTISF = max(0, INTANISF - V_ANREV + 1 * 12 + INTMSISF - 6) * TXMOISRETARD2 * present(MOISAN_ISF)


PTOISF = arr(ISF5 * COPETOISF / 100) + arr(ISF5 * TXINTISF / 100)


RETISF = RETISF2 + arr(ISF5 * TXINTISF / 100) * positif_ou_nul(ISF4BIS - SEUIL_12)


RETXISF = positif(CMAJ_ISF) * TXINTISF + TXINRISF * 1 - positif(TXINRISF_A) + -1 * positif(TXINRISF_A) * positif(TXINRISF) * positif(positif(TXINRISF - TXINRISF_A) + positif(TXINRISF_A - TXINRISF)) + TXINRISF * positif(TXINRISF_A) * null(TXINRISF - TXINRISF_A)


NATMAJISF = positif(positif(RETISF) * positif(NMAJISF1) + positif(NMAJISF1)) + 2 * positif(RETISF) * 1 - positif(NMAJISF1)

PISF = INCISF_NET + NMAJISF1 + arr(ISF5 * TXINTISF / 100) * 1 - positif(FLAG_PRIM + FLAG_RETARD + FLAG_DEFAUT)

NAPISFTOT = ISF5 + PISF

ISFNET = NAPISFTOT

ISFNAP = ISFCUM - V_ANTISF

ILI_SYNT_ISF = 1 - positif_ou_nul(ISF4BIS - SEUIL_12) * null(V_ANTISF + 0) * ISF4BIS + positif_ou_nul(ISF4BIS - SEUIL_12) * ISF4BIS

ISF4BIS = max(0, ISF5)
